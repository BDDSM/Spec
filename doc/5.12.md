# Управляемые формы 12

Организовать учет товаров в разрезе сроков годности. В документе «Расходная накладная» необходимо создать управляемую основную форму документа, в которой пользователь должен иметь возможность при выборе товара сразу же выбирать и срок годности. Сроки годности для выбора должны быть доступны только те, которые еще не списаны по данному товару. Сам выбор срока должен осуществляться следующим образом:
1. При выборе товара открывается окно, в котором пользователь выбирает товар;
2. После выбора товара, для пользователя сразу же (без возвращения к редактированию документа) должна открыться новая форма, в которой будут отображены остатки в разрезе сроков годности по выбранному товару;
3. После выбора срока годности, в документ должен подставиться сам товар, срок годности и количество, равное остатку.

## Решение

Задача делается на оповещениях о выборе.

Открывается форма с выбором номенклатуры. После того, как прилетает выбранное значение, следом открывается следующая форма.

Здесь отслеживание идёт в обработке выборка. Смотрим, какой тип значения пришёл из формы выбора: в обном случае открываем следующую форму выбора, иначе добавляем новый элемент. Т.е.:
- пришла номенклатура – открываем форму подбора срока годности;
- пришла структура (уже выбран срок годности) – получаем срок годности и количество по остатку.

Таким образом делаеются формы выбора номенклатуры и срока годности. Передаётся параметром номенклатура, и по дате документа получаем срок годности и остатки.
